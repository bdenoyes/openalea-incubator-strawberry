)
tab2<- fc_dist_order_by_date(data = dat,
genotype = "Gariguette",
prob = "cumulative")
kable(x = tab2,
caption = "Module order frequency distribution for successive date",digits = 2)
fc_dist_order_by_date.plot(data=tab2)+
geom_hline(yintercept = 0.9,linetype="dashed")
tab3<-fc_dist_variable_by_order(data = dat,genotype = "Gariguette",varname = "nb_total_leaves",prob = "cumulative")
kable(x = tab3,
caption = "Cumulative distribution of total no. leaves by orders",digits = 2)
fc_dist_variable_by_order.plot(data = tab3)+
xlab("No. Leaves")+
ylab("Cumulative distribution function")
d2 <-data.frame(matrix(nrow = nrow(dat),ncol=ncol(dat)))
d2[,1:ncol(d2)]<-dat[,1:ncol(dat)]
colnames(d2)<- colnames(dat)
d2[d2$Index==5,]<-4
fc_dist_module_by_order(data = d2)
ggplot(data = data_at_module_scale,
mapping = aes(
x = Index,
y = MeanTotalLeave,
group=genotype)
)+
geom_line(mapping = aes(color=genotype))+
geom_point(mapping = aes(color=genotype))+
xlab("Order")+
ylab("Mean No. leaves")
for (i in 1:nrow(d2)){
if (d2[i,'Index']=="5"){
d2[i,"Index"]<- 4
}else d2[i,"Index"] <-dat[i,"Index"]
}
fc_dist_module_by_order(data = d2)
d2<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
d2[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
d2[i,"Index"]<- 4
}
}
fc_dist_module_by_order(data = d2)
d2<-data[2:colend]
View(d2)
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
d2[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
d2[i,"Index"]<- 4
}
}
fc_dist_module_by_order(data = d2)
View(d2)
source(file = "c:/Users/mlabadie/Documents/GitHub/strawberry/Rscript/Functions.R")
d2<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
d2[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
d2[i,"Index"]<- 4
}
}
fc_dist_module_by_order(data = d2)
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE, dpi = 800,fig.pos = "h")
library(plyr)
library(ggplot2)
library(gtable)
library(grid)
library(cowplot)
library(reshape2)
library(scales)
library(knitr)
library(tinytex)
library(dplyr)
#library(RCurl)
library(rmarkdown)
source(file = "c:/Users/mlabadie/Documents/GitHub/strawberry/Rscript/Functions.R")
DataSet <- read.csv(
"c:/Users/mlabadie/Documents/GitHub/strawberry/Rscript/Dataset.csv",
sep=";",na.strings = "-1")
colstart<-1
colend<-dim(DataSet)[2]-2
data<-DataSet[,c(colstart:colend)]
str(object = data)
data$genotype<- as.factor(data$genotype)
data$date<- as.factor(DataSet$date)
data$Crown_status<- as.factor(DataSet$Crown_status)
data$type_of_crown<- as.factor(DataSet$type_of_crown)
# Convert numerical categorical ordered value in factor values with their properties
data$genotype<- factor(x = data$genotype,
levels = levels(x = data$genotype),
labels = c("Gariguette","Ciflorette","Clery","Capriss","Darselect","Cir107")
)
data$date<- factor(x = data$date,
levels = levels(x = data$date),
labels = c("Mid-December","Early-Junuary","Mid-February","Early-March","Early-April","Early-June")
)
data$type_of_crown<- factor(x = DataSet$type_of_crown,
levels = levels(x = data$type_of_crown),
labels = c("Primary_Crown","Extention_Crown","Branch_Crown")
)
data$Crown_status<- factor(x = data$Crown_status,
levels = levels(x = data$Crown_status),
labels = c("Terminal_Vegetative_bud","Terminal_initiated_bud","Terminal_Floral_bud","Terminal_Inflorescence"))
#convert index sequence analysis in index for R analysis
dat<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
dat[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
dat[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
dat[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
dat[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
dat[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
dat[i,"Index"]<- 5
}else if (data[i,'Index']=="1"){
dat[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
dat[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
dat[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
dat[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
dat[i,"Index"]<- 5
}else if (data[i,'Index']=="2"){
dat[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
dat[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
dat[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
dat[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
dat[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
dat[i,"Index"]<- 4
}
}
dat$Index<-as.factor(x = dat$Index)
kable(x = dat,digits = 2,caption = "Data extract from MTG")
data_at_module_scale<-ddply(.data = dat,
.variables = c("genotype","Index"),
summarise,
MeanTotalLeave= round(x = mean(x = nb_total_leaves,
na.rm = T),
digits = 0),
SdTotalLeave= sd(x = nb_total_leaves,
na.rm = T),
MeanTotalFlower= round(mean(x = nb_total_flowers,
na.rm = T),
digits = 0),
SdTotalFlower= sd(x = nb_total_flowers,
na.rm = T),
MeanStolon= round(mean(x = stolons,
na.rm = T),
digits = 0),
SdStolon= sd(x = stolons,
na.rm = T),
N=length(nb_total_leaves))
kable(x = data_at_module_scale,caption = " Data at module scale")
tab1<- fc_dist_module_by_order(data = dat)
kable(x = tab1,
caption = "No. Module by varieties for successive orders "
)
tab2<- fc_dist_order_by_date(data = dat,
genotype = "Gariguette",
prob = "cumulative")
kable(x = tab2,
caption = "Module order frequency distribution for successive date",digits = 2)
fc_dist_order_by_date.plot(data=tab2)+
geom_hline(yintercept = 0.9,linetype="dashed")
tab3<-fc_dist_variable_by_order(data = dat,genotype = "Gariguette",varname = "nb_total_leaves",prob = "cumulative")
kable(x = tab3,
caption = "Cumulative distribution of total no. leaves by orders",digits = 2)
fc_dist_variable_by_order.plot(data = tab3)+
xlab("No. Leaves")+
ylab("Cumulative distribution function")
d2<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
d2[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
d2[i,"Index"]<- 4
}
}
fc_dist_module_by_order(data = d2)
d2$Index
levels(d2$Index)
levels(d2$Index)
d2<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
d2[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
d2[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
d2[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
d2[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
d2[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
d2[i,"Index"]<- 4
}
}
d2$Index<-as.factor(d2$Index)
levels(d2$Index)
fc_dist_module_by_order(data = d2)
data_at_module_scale_group<-ddply(.data = dat,
.variables = c("genotype","Index"),
summarise,
MeanTotalLeave= round(x = mean(x = nb_total_leaves,
na.rm = T),
digits = 0),
SdTotalLeave= sd(x = nb_total_leaves,
na.rm = T),
MeanTotalFlower= round(mean(x = nb_total_flowers,
na.rm = T),
digits = 0),
SdTotalFlower= sd(x = nb_total_flowers,
na.rm = T),
MeanStolon= round(mean(x = stolons,
na.rm = T),
digits = 0),
SdStolon= sd(x = stolons,
na.rm = T),
N=length(nb_total_leaves))
kable(x = data_at_module_scale_group,caption = " Data at module scale")
dat_group<-data[2:colend]
dat_group<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
dat_group[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
dat_group[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
dat_group[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
dat_group[i,"Index"]<- 4
}
}
d2$Index<-as.factor(d2$Index)
fc_dist_module_by_order(data = d2)
data_at_module_scale_group<-ddply(.data = dat_group,
.variables = c("genotype","Index"),
summarise,
MeanTotalLeave= round(x = mean(x = nb_total_leaves,
na.rm = T),
digits = 0),
SdTotalLeave= sd(x = nb_total_leaves,
na.rm = T),
MeanTotalFlower= round(mean(x = nb_total_flowers,
na.rm = T),
digits = 0),
SdTotalFlower= sd(x = nb_total_flowers,
na.rm = T),
MeanStolon= round(mean(x = stolons,
na.rm = T),
digits = 0),
SdStolon= sd(x = stolons,
na.rm = T),
N=length(nb_total_leaves))
kable(x = data_at_module_scale_group,caption = " Data at module scale")
dat_group<-data[2:colend]
for (i in 1:nrow(data)){
if (data[i,'Index']=="0"){
dat_group[i,"Index"]<- 0
}else if (data[i,'Index']=="0-1"){
dat_group[i,"Index"]<- 1
}else if (data[i,'Index']=="0-1-2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="0-1-2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="0-1-2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="0-1-2-3-4-5"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="1"){
dat_group[i,"Index"]<- 1
}else if (data[i,'Index']=="1-2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="1-2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="1-2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="1-2-3-4-5"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="2"){
dat_group[i,"Index"]<- 2
}else if (data[i,'Index']=="2-3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="2-3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="3"){
dat_group[i,"Index"]<- 3
}else if (data[i,'Index']=="3-4"){
dat_group[i,"Index"]<- 4
}else if (data[i,'Index']=="4"){
dat_group[i,"Index"]<- 4
}
}
dat_group$Index<-as.factor(dat_group$Index)
fc_dist_module_by_order(data = dat_group)
View(tab1)
kable(x = data_at_module_scale_group,caption = " Data at module scale after grouping")
ggplot(data = data_at_module_scale_group,
mapping = aes(
x = Index,
y = MeanTotalLeave,
group=genotype)
)+
geom_line(mapping = aes(color=genotype))+
geom_point(mapping = aes(color=genotype))+
xlab("Order")+
ylab("Mean No. leaves")
ggplot(data = data_at_module_scale_group,
mapping = aes(
x = Index,
y = MeanTotalLeave,
group=genotype)
)+
geom_line(mapping = aes(color=genotype))+
geom_point(mapping = aes(color=genotype))+
xlab("Order")+
ylab("Mean No. leaves")+
ylim(0,20)
ggplot(data = data_at_module_scale_group,
mapping = aes(
x = Index,
y = MeanTotalLeave,
group=genotype)
)+
geom_line(mapping = aes(color=genotype))+
geom_point(mapping = aes(color=genotype))+
xlab("Order")+
ylab("Mean No. leaves")+
ylim(0,12)
